---
description: AI rules derived by SpecStory from the project AI interaction history
globs: *
---

## HEADERS

(No existing headers)

## TECH STACK

*   The AI coding assistant can now use Node.js version v22.17.1 for project development.
*   The AI coding assistant can now use the following libraries: next, react, react-dom, tailwindcss, postcss, autoprefixer and lucide-react.
*   The AI coding assistant can now use Bun v1.2.19 as a package manager.
*   The AI coding assistant can now use Next.js version 16.0.7.
*   The AI coding assistant can now use React version 19.2.0.
*   The AI coding assistant can now use React-dom version 19.2.0.

## PROJECT DOCUMENTATION & CONTEXT SYSTEM

*   **Last Updated:** December 8, 2025
*   **Status:** Phase 4 Specification Complete - Ready for Implementation
*   **Current Phase:** Phase 4 - Theme Generator
*   When updating the design system app's UI, always use the design system itself and best practices in UI and visual rhythm to standardize the use of color, giving each color a purpose. Prefer shades over using too many distracting colors.
*   When modernizing the design system, follow the "Modernization 2.0" style guidelines, which include strict guidelines for the color system, typography, and component usage.
*   Reference the `styleguide.md` file for detailed Modernization 2.0 style rules.
*   Refer to the existing UI and `@design-system-ui/styleguide.md` when updating the theme generator plan to incorporate style constraints and functional specifications.
*   **Project Setup:** Update the `@README.md` file with the current project overview and structure. This rule was extracted from a user interaction on 2025-12-08.

### Token Architecture Layers

````
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  05-Greenshift (Framework Adapter)                          â”‚
â”‚  WordPress/Greenshift CSS custom properties                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  04-Components                                              â”‚
â”‚  Button, Card, Input component tokens                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  03-Semantic                                                â”‚
â”‚  Role-based tokens: Brand, Background, Text, Status         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  02-Typography                                              â”‚
â”‚  Type scales: Major Second (1.125) / Major Third (1.25)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  01-Primitives                                              â”‚
â”‚  Raw values: Colors, Spacing, Radius, etc.                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
````

### Source Token Files

Located in `/tokens/`:
- `01-Primitives.json` - 22 color families, spacing, radius, etc.
- `02a-Typography-MajorSecond.json` - Conservative type scale
- `02b-Typography-MajorThird.json` - Expressive type scale
- `03-Semantic.json` - Light/Dark mode semantic tokens
- `04-Components.json` - Button, Card, Input tokens
- `05-Greenshift.json` - WordPress variable mapping

### Target File Structure

````
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ tokens/
â”‚   â”‚       â”œâ”€â”€ route.ts              (GET all tokens)
â”‚   â”‚       â”œâ”€â”€ primitives/route.ts
â”‚   â”‚   â”œâ”€â”€ semantic/route.ts
â”‚   â”‚   â”œâ”€â”€ components/route.ts
â”‚   â”‚   â”œâ”€â”€ typography/route.ts
â”‚   â”‚   â”œâ”€â”€ greenshift/route.ts
â”‚   â”‚   â””â”€â”€ export/route.ts       (Export theme as CSS/JSON)
â”‚   â”œâ”€â”€ tokens/
â”‚   â”‚   â”œâ”€â”€ primitives/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              (Primitives overview)
â”‚   â”‚   â”‚   â””â”€â”€ colors/page.tsx       (22 color palettes)
â”‚   â”‚   â”œâ”€â”€ semantic/page.tsx         (Semantic tokens)\nâ”‚   â”‚   â”œâ”€â”€ components/page.tsx         (Component tokens)
â”‚   â”‚   â”œâ”€â”€ colors/page.tsx           (UPDATE existing)
â”‚   â”‚   â”œâ”€â”€ typography/page.tsx       (UPDATE existing)\nâ”‚   â”‚   â””â”€â”€ spacing/page.tsx          (UPDATE existing)\nâ”‚   â”œâ”€â”€ frameworks/
â”‚   â”‚   â””â”€â”€ greenshift/page.tsx       (WordPress mapping)
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ explorer/page.tsx         (Token playground)
â”‚   â”‚   â””â”€â”€ relationships/page.tsx    (Node flow viewer)
â”‚   â”œâ”€â”€ preview/page.tsx              (UPDATE existing)
â”‚   â””â”€â”€ page.tsx                      (UPDATE home)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ tokens/
â”‚   â”‚   â”œâ”€â”€ TokenChip.tsx
â”‚   â”‚   â”œâ”€â”€ ColorSwatch.tsx
â”‚   â”‚   â”œâ”€â”€ ColorPaletteGrid.tsx
â”‚   â”‚   â”œâ”€â”€ SpacingVisual.tsx
â”‚   â”‚   â”œâ”€â”€ RadiusCurveIcon.tsx
â”‚   â”‚   â””â”€â”€ TokenReferenceChain.tsx
â”‚   â”œâ”€â”€ TokenFlowDiagram.tsx
â”‚   â”œâ”€â”€ TokenSearch.tsx
â”‚   â””â”€â”€ Sidebar.tsx                   (UPDATE)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ tokens/
â”‚   â”‚   â”œâ”€â”€ parser.ts                 (Parse JSON tokens)
â”‚   â”‚   â”œâ”€â”€ resolver.ts               (Resolve references)
â”‚   â”‚   â”œâ”€â”€ chains.ts                 (Build dependency chains)
â”‚   â”‚   â””â”€â”€ export.ts               (Export utilities)
â”‚   â””â”€â”€ types.ts                      (TypeScript interfaces)
â””â”€â”€ data/
    â””â”€â”€ tokens/                       (Cached/imported token data)
````

### Technical Notes

#### Token Reference Format

Tokens reference each other using this path format:
````
{CollectionName.modes.ModeName.Group.Subgroup.Variable}
````

Example chain:
````
Greenshift.Light.Preset.Color.brand
  â†’ {Semantic.modes.Light.Color.Brand.Default}
    â†’ {Primitives.modes.Default.Color.Emerald.400}
      â†’ #34d399
````

**Styling and Naming Conventions:**
*   Maintain consistent styling for token mapping callouts across all pages.
*   Use either CSS variables (vars) or dot notation consistently; do not mix them.
*   The token flow should be documented with the Raw value first, then Primitive, Semantic, Component, etc., from left to right.
*   Favor the chip style (with icon and border) for token references, similar to the architecture box, over the chips in the chain box.
*   Ensure copy-paste buttons and icon styling are consistent across the app.

#### API Response Format
````typescript
interface TokenResponse {
  collection: string;
  mode?: string;
  tokens: Token[];
  metadata: {
    count: number;
    types: string[];
    lastUpdated: string;
  };
}

interface Token {
  path: string;           // "Color.Emerald.400"
  name: string;           // "Emerald 400"
  value: string | number; // "#34d399" or 24
  type: string;           // "color" | "number"
  cssVariable: string;    // "--primitives-color-emerald-400"
  reference?: string;     // "{Primitives.modes.Default.Color.Emerald.400}"
  wpVariable?: string;    // "--wp--preset--color--brand"
}
````

#### CSS Variable Naming Convention
- Primitives: `--primitives-{group}-{name}-{shade}`
- Semantic: `--semantic-{category}-{role}`
- Components: `--component-{component}-{property}`
- Greenshift: `--wp--{preset|custom|style}--{path}`

### Quick Links

- Token Files: `/tokens/`
- Current App: `http://localhost:3000`
- Figma Import Guide: `/tokens/IMPORT-GUIDE.md`
- CSS Reference: `/tokens/css-variables-reference.md`
- Modernization 2.0 Styleguide: `/styleguide.md`

## WORKFLOW & RELEASE RULES

*   When creating a new design system application, always create a new react/nextjs app to preview updates locally before pushing the code live. Do not edit existing files directly.
*   After re-authenticating with GitHub CLI, always configure git with the appropriate email before pushing any code.
*   After initializing a git repository, always configure git with the appropriate email before adding files.
*   **Correct GitHub Commits:** Ensure all local files and previous commits are associated with the `altitudemarketing` GitHub organization under the correct user account.
*   **Project Setup:** Update the `@README.md` file with the current project overview and structure.
*   **Git Ignore:** Add the `old design systems` folder to the `.gitignore` file.
*   **Package Manager:** Use Bun for package management.

## CODING STANDARDS

*   When creating new UI elements for the design system, always adhere to the existing primitives and semantic names defined in the project's JSON and CSS files.
*   Always use an 8px grid system for spacing and sizing.
*   When creating theme settings, ensure that the spacing density controls vertical gaps and line heights, not just button padding.
*   In typography previews, ensure headings have appropriate line heights (`line-height: 1.1` for headings).
*   Style code tokens (e.g., "body", "clamp()") in code notation (e.g., red text with a rose background).
*   When displaying CSS variable information:
    *   Use the `VarInfo` component, which takes an array of variables and displays them as individual styled code badges.
    *   Include an optional `note` prop for explanatory text.
    *   Style each variable as a subtle pill with background highlighting.
    *   Avoid confusing arrow notation (e.g., `â†’`).
    *   Show actual wildcard patterns rather than cryptic formats (e.g., `*--mt`).
*   On the typography page, the grid should use proportional column widths instead of equal columns using the following values:
    *   The Token column should have a width of `1.5fr`.
    *   The Semantic Use column should have a width of `0.8fr`.
    *   The Size Range column should have a width of `0.8fr`.
    *   The Clamp Value column should have a width of `2fr`.
    *   The Preview column should have a width of `0.5fr`.
    *   The gap between columns should be `var(--spacing-3)` (12px).
*   On the preview page, line height variables and clamp sizes must be displayed in fields that users can click to copy the CSS value/variable.
*   The same copy-to-clipboard functionality should be implemented for colors on the preview page.
*   If line heights are rem values, always specify the "rem" unit label.
*   Ensure consistent styling across pages by adding copyable fields to token values.
*   Use `--line-height-snug` (1.25) for subtext and body copy line heights across all pages.
*   The border radius section on the spacing page should use the same clean table-based design with filled green squares that is used on the semantic tokens page.
*   All copy buttons should make the variable listed like var() the actual button with copy icon in it.
*   Components used in the theme generator mockup must adhere to consistent component creation specifications to avoid inconsistencies in displaying variables.
*   Feature card icons should all use the accent color (400 shade) defined in the theme generator.
*   The secondary color should also load at shade 400 like the brand and accent do.
*   In the Theme Generator, the button in the left sidebar that navigates back to the dashboard must say "Back to dashboard".
*   Always make all of the swatch cards the same larger size.
*   **Rollback:** Revert the token chain display to horizontal (left to right) from raw value to the output layer (component/greenshift/semantic).
*   Always follow the styling of the badges in the token reference chain callout, using the same icon as the page the token is from. So instead of a cube for the component variable badge, use the same icon as the Component Tokens page H1.
*   Always follow the reference chain pattern and dot notation to include the component variable after the icon instead of just saying component (e.g., "Button.Background").
*   Update the Greenshift variable page to match the same token chain styles and icons, using the globe icon for the GRS page for consistency.
*   The last token layer should be at the top in the token chain elements. All the arrows in these elements need to point up and not down, even in the Token Chain part of Generator
*   Center align the arrows and badges in the token chain displays.

## DEBUGGING

(No existing debugging rules)

## STYLE GUIDES

*   Remove the visual view from the spacing page. The table view looks better.
*   The copy paste buttons and icon styling must be consistent across the app. The colors page particulary looks bad as both copy buttons are inside the color swatch.
*   On the primitives page, the token flow must be: raw value â†’ primitive â†’ semantic.
*   On the primitives page, the chips must be styled like other pages, using icons and colored backgrounds.
*   Copy paste buttons should be next to the value its copying.
*   Copy paste buttons should have a brief tooltip pop up that says "Variable copied!".
*   The line height visuals should clearly represent the different values.
*   The tooltip from the copy paste button must display the text and not be cropped by the box its in.
*   The order of the var flow on the Greenshift page must reflect the raw to Semantic left/right flow that the other pages follow, showing the primitive/raw value on the left flowing through to the framework-specific output on the right.
*   On the Greenshift page, the hex values must be to the left of the primitive var with an arrow to the right pointing to the primitive.
*   The section title for Foundations must be renamed to Primitives.
*   The current Primitive page must be the primitives Overview page, followed by the Colors, Typography, Spacing & Layout pages, so the section follows the same order and hierarchy as the others.
*   When clicking "Primitives Overview" then "Colors," the active state should only be applied to the "Colors" menu item. The `isActive` function in `Sidebar.tsx` must use exact path matching to prevent both "Overview" and "Colors" from appearing active simultaneously. The original logic using `startsWith` has been replaced with exact matching.
*   The reference chain on the Greenshift page must flow left-to-right from raw to semantic, showing the primitive/raw value on the left flowing through to the framework-specific output on the right.
*   All section header icons should be vertically aligned with the corresponding title text.
*   **Icon Style Rules:**
    *   **H1 Page Titles:** Use `var(--color-secondary)` icon with white background (`var(--color-card)`) and a light thin border (`1px solid rgba(68, 75, 140, 0.2)`).
    *   **Small Icons Inside a Callout:** Use a dark purple icon only (`var(--color-secondary)`) with no border or background.
    *   **H2 Titles and Icon Pairs:** Use `var(--color-secondary)` icon, light purple background (`rgba(68, 75, 140, 0.08)`), and no border.
    *   All icons should be visually centered vertically with their title by matching the title's line-height.
*   Icons used for page or section titles must be unique and representative of the area being referenced.
    *   The H1 icon must match what is used in the sidebar menu icon.
    *   Sub section icons must be unique and representative of that section.
    *   For instance, the two-layer architecture icon should be a layer icon, not a palette.
    *   The typography page's H1 title should use the "T" icon.
    *   The typography "Type Scale" section should use something like "Aa" or 2 different size letters to represent the "scale".
*   Title icons in collapsible sections of the sidebar should be simple and white, without any border or background.
*   Collapsible sections and sidebar panels should have more contrast against the sidebar background and each other.
*   The "Resolved value" section in the token inspector should be positioned between the "Text Heading" and the "Token Chain" sections in the theme generator.
*   The token chain UI panel should be improved to offer a better visualization than the current colored lines with circles.
*   The theme generator icon should be a simpler version without a background color.
*   The beta badge should use a different color (maybe purple or blue) for visual distinction from the export button.
*   The element clicker hint should be more subtle/neutral and not draw excessive attention.
*   In the Theme Generator, the instruction text "Click any element to inspect" must be displayed as subtext under the "Token Inspector" heading, accompanied by a smaller mouse icon.

## NAMING CONVENTIONS

*   Use the following semantic names for card typography in CSS:
    *   `--card-title-font-size`: Uses `--font-size-body` (16-25px) â€” same size as body text but used with bold/semibold weight
    *   `--card-title-lg-font-size`: Uses `--font-size-lead` (20-31px) â€” for larger card titles
    *   `--card-subtitle-font-size`: Uses `--font-size-body-small` (13-20px) â€” for card descriptions
    *   `--card-meta-font-size`: Uses `--font-size-caption` â€” for metadata

## ERROR HANDLING

(No existing error handling rules)

## SECURITY

(No existing security rules)

## DEPLOYMENT

*   When deploying to Vercel, if the Next.js app is in a subdirectory (e.g., `ui`), configure Vercel as follows:
    *   **Option 1: Set Root Directory (Recommended):**
        *   **Root Directory:** `ui`
        *   **Build Command:** `bun run build` (or leave as default)
        *   **Output Directory:** `.next` (default)
    *   **Option 2: Custom Build Command:**
        *   **Root Directory:** `.` (empty/default)
        *   **Build Command:** `cd ui && bun run build`
        *   **Output Directory:** `ui/.next`
*   **Deploying to Vercel:**
    *   If a Vercel project already exists for the GitHub repository:
        1.  Go to the Vercel dashboard for the `altitude-projects` team: `https://vercel.com/altitude-projects`
        2.  Locate the existing project in the project list.
        3.  Click on the project and navigate to **Settings** â†’ **Git**.
        4.  Reconnect or reconfigure the GitHub repository connection.
    *   If deploying via Vercel CLI:
        1.  Install Vercel CLI globally: `npm i -g vercel`
        2.  Navigate to the project directory: `cd "/Users/scottfoster/git/design system"` (adjust path as necessary)
        3.  Login to Vercel: `vercel login` (this will open a browser window).
        4.  Deploy: `vercel`. When prompted, link to the existing project or create a new one.
    *   To link to an existing project directly using the Vercel CLI: `vercel link`
*   **Vercel Deployment Troubleshooting:** If encountering a "repo already exists" error when importing from GitHub, even after deleting existing Vercel projects:
    1.  **Disconnect the Repo from Vercel's GitHub App:**
        1.  Go to GitHub â†’ **Settings** â†’ **Applications** â†’ **Installed GitHub Apps** (https://github.com/settings/installations).
        2.  Find **Vercel** in the list and click **Configure**.
        3.  Under "Repository access," remove the specific repo and re-add it.
    2.  **Clear Vercel's Connection:**
        1.  Go to your Vercel dashboard: `https://vercel.com/altitude-projects`.
        2.  Click on your **team settings** (gear icon or "Settings" in the sidebar).
        3.  Go to **Git** or **Integrations** â†’ **GitHub**.
        4.  Look for any "connected repositories" and disconnect the problematic one.
    3.  **Alternative: Use Vercel CLI:**
        ```bash
        cd "/Users/scottfoster/git/design system"
        npx vercel --yes
        ```
        This will deploy directly and create a new project without needing the GitHub import flow.
*   **Vercel Build Configuration:** When deploying to Vercel, the Next.js app is in the `ui` subdirectory. Ensure the correct settings are used:
    *   **Option 1: Set Root Directory (Recommended):**
        *   **Root Directory:** `ui`
        *   Update `ui/vercel.json` to the following:
            ```json
            {
              "buildCommand": "cp -r ../tokens . && bun run build"
            }
            ```
        *   Ensure the root `package.json` does not include `next` as a dependency.
        *   Go to your project â†’ **Settings** â†’ **General** in the Vercel Dashboard.
        *   Set the **Root Directory** to `ui`.
    *   **Option 2: Custom Build Command:**
        *   **Root Directory:** `.` (empty/default)
        *   **Build Command:** `cd ui && bun run build`
        *   **Output Directory:** `ui/.next`

## TODO LIST

### Phase 1: Documentation & Updates
> **Goal:** Update all existing pages with new token data and add comprehensive documentation

The progress tracker reports "28/28 tasks" for Phase 1, but manually counting all checkbox items across sections 1.1-1.7 yields 31 completed items (11+6+6+1+1+1+5). The task count appears to be outdated and does not reflect the actual number of checklist items present in the phase documentation. The updated count is reflected below.

#### 1.1 Data Layer Setup
- [x] Create TypeScript interfaces for token structure (`lib/types.ts`)
- [x] Create token parser utility (`lib/tokens/parser.ts`)
- [x] Create reference resolver utility (`lib/tokens/resolver.ts`)
- [x] Create dependency chain builder (`lib/tokens/chains.ts`)
- [x] Set up API route for primitives (`api/tokens/primitives/route.ts`)
- [x] Set up API route for semantic tokens (`api/tokens/semantic/route.ts`)
- [x] Set up API route for component tokens (`api/tokens/components/route.ts`)
- [x] Set up API route for typography (`api/tokens/typography/route.ts`)
- [x] Set up API route for greenshift (`api/tokens/greenshift/route.ts`)
- [x] Set up main API route (`api/tokens/route.ts`)
- [x] Set up export API route (`api/tokens/export/route.ts`)

#### 1.2 Reusable Components
- [x] Create `TokenChip` component (color swatch + metadata)
- [x] Create `ColorSwatch` component (enhanced with references)
- [x] Create `ColorPaletteGrid` component (22 Ã— 11 grid)
- [x] Create `SpacingVisual` component (visual bar + value)
- [x] Create `RadiusCurveIcon` component (corner curve visualization)
- [x] Create `TokenReferenceChain` component (inline reference display)

#### 1.3 Primitives Documentation
- [x] Create Primitives overview page (`tokens/primitives/page.tsx`)
- [x] Create full color palettes page (`tokens/primitives/colors/page.tsx`)
  - Display all 22 color families (Slate through Rose + Base)
  - 11 shades per family (50-950)
  - Copy-to-clipboard for CSS variables and hex values
- [x] Update spacing page with new primitive data
- [x] Add radius documentation to primitives
- [x] Add duration/animation tokens documentation
- [x] Add font weights and line heights documentation

#### 1.4 Semantic Tokens Documentation
- [x] Create Semantic tokens page (`tokens/semantic/page.tsx`)
  - Color roles: Brand, Secondary, Background, Surface, Text, Card, Border, Status
  - Radius roles: Button, Card, Input, Badge, Modal
  - Layout: ContentWidth, WideWidth, ProseWidth
  - Show reference to primitive source

#### 1.5 Component Tokens Documentation
- [x] Create Component tokens page (`tokens/components/page.tsx`)
  - Button tokens (all variants)
  - Card tokens
  - Input tokens
  - Show reference chain to semantic â†’ primitives

#### 1.6 Greenshift/WordPress Documentation
- [x] Create Greenshift page (`frameworks/greenshift/page.tsx`)
  - Preset color mappings
  - Custom properties (Button, Card, Input, Badge, Modal)
  - Style global settings
  - Copy-ready CSS code blocks

#### 1.7 Update Existing Pages
- [x] Update Colors page with semantic + primitive organization
- [x] Update Typography page with scale comparison (Major Second vs Major Third)
- [x] Update Spacing page with primitive spacing scale
- [x] Update Home page with accurate token counts
- [x] Update Sidebar navigation with new structure

### Phase 3: Export/Import API Themer
> **Goal:** Full playground with live preview, value editing, and theme export

#### 3.1 Token Playground
- [ ] Create Token Explorer page (`tools/explorer/page.tsx`)
- [ ] Implement searchable/filterable token list
- [ ] Add token type filters (color, number, string)
- [ ] Add layer filters (Primitive, Semantic, Component, Greenshift)
- [ ] Implement live value editing
- [ ] Show real-time preview updates

#### 3.2 Theme Preview Updates
- [ ] Update Preview page to use API data
- [ ] Add token variable names on component hover
- [ ] Implement "swap primitive reference" functionality
- [ ] Add theme state management
- [ ] Show active token overrides

#### 3.3 Export API
- [ ] Create export API route (`api/tokens/export/route.ts`)
  - Support CSS variables export format
  - Support JSON export format
  - Support Figma-compatible JSON export
  - Support WordPress theme.json export
- [ ] Add export UI with format selector

#### 3.4 Import/Save Themes
- [ ] Create import functionality for custom themes
- [ ] Add theme presets (default, custom variations)
- [ ] Implement theme saving (localStorage initially)
- [ ] Add "Share Theme" URL generation

### Phase 4: Theme Generator Component Specifications and Plan

#### 4.1 Theme Generator Components
- [ ] Create `ThemeBuilderContext` for state management of the "Draft Theme".
- [ ] Initial state of `ThemeBuilderContext` should populate from existing JSON token files.
- [ ] Action: `updateSemanticColor(role: 'Brand', primitive: 'Indigo', step: 500)`
- [ ] Create `TokenMapper`: A dropdown listing Primitives (with their color swatches) and assigning them to a Semantic slot.
- [ ] Create `VariableInjector`: A wrapper component that writes the current state to inline `style` variables, ensuring performant, instant updates without re-compiling CSS.
- [ ] Create HTML mockup of the Theme Generator.

#### 4.2 Theme Generator Functionality
- [ ] Educational Visualization: UI must explicitly label the layers: `Primitive Source` â†’ `Semantic Token` â†’ `Component Instance`.
- [ ] Allow rapid prototyping of a new visual identity (e.g., "What if our brand was Indigo instead of Emerald?").
- [ ] **Color**: Select Primitive families (e.g., Blue, Slate) for key Semantic roles (Brand, Surface, Status).
- [ ] **Tweak**: Sliders for fine-tuning (Shade/Tint adjustments).
- [ ] **Globals**: Sliders for `Radius` (Small vs. Round) and `Typography` scale (Major Second vs. Major Third).
- [ ] Users need to see "real" results, not just abstract swatches in a "Live Mockup" section featuring common UI patterns: a Dashboard Card, a Form, a Modal, and Navigation components. These must react instantly to variable changes.
- [ ] A simple "Export Theme" button that generates a JSON file. This file mimics the structure of `tokens/03-Semantic.json`, ready for import into the Figma Variables plugin.

#### 4.3 Theme Generator Interface Layout
- [ ] **Sidebar/Panel**: "Controls" area. Grouped by "Color Mapping", "Typography", and "Shape".
- [ ] **Main Stage**: "Preview" area. A sticky or scrollable view of the Mockup UI.

## PROGRESS TRACKER

| Phase | Status | Progress |
|-------|--------|----------|
| Phase 1: Documentation | ðŸŸ¢ Complete | 31/31 tasks |
| Phase 2: Relationships | âšª Pending | 0/14 tasks |
| Phase 3: Export/Import | âšª Pending | 0/17 tasks |
| Phase 4: Theme Generator | âšª Pending | 0/13 tasks |

**Total Progress:** 31/75 tasks (41%)

## SIDEBAR RULES

*   The section title for Foundations must be renamed to Primitives.
*   The current Primitive page must be the primitives Overview page, followed by the Colors, Typography, Spacing & Layout pages, so the section follows the same order and hierarchy as the others.
*   When clicking "Primitives Overview" then "Colors," the active state should only be applied to the "Colors" menu item. The `isActive` function in `Sidebar.tsx` must use exact path matching to prevent both "Overview" and "Colors" from appearing active simultaneously. The original logic using `startsWith` has been replaced with exact matching.
*   The reference chain on the Greenshift page must flow left-to-right from raw to semantic, showing the primitive/raw value on the left flowing through to the framework-specific output on the right.

## MODERNIZATION PLAN

The following rules should be followed when modernizing the design system:

### 1. Color Standardization
*   Stats and headers should use a strict theme:
    *   `var(--color-brand)` (Teal) for active elements and key values.
    *   `var(--color-secondary)` (Deep Purple) for architectural/structural elements.
    *   Neutral grays for labels and secondary text to reduce visual noise.

### 2. Component Consistency
*   "Stats" and "Callouts" should be styled consistently:
    *   Unified Stats Cards: Standardize to a clean, single-style card using the Brand color for data and Neutrals for labels.
    *   Standardized Callouts: Create a consistent pattern for "Info" and "Note" boxes using semantic background tints (e.g., `rgba(var(--color-brand-rgb), 0.05)`).

### 3. Typography Refinement
*   The documentation site should use the **Major Second (Conservative)** scale to prevent large type scale jumps. This creates a more professional, readable rhythm suitable for documentation.

### 4. Copy Button Implementation
*   All copy buttons should transform the display of variables, specifically those like `var()`, into actual copy buttons with icons. This should be implemented across all pages, including `PrimitivesPage`.

### 5. Modernization 2.0 Guidelines
*   When updating pages to match the new "Modernization 2.0" style of the Design System documentation, follow these strict guidelines:

    *   **Color System & Theming:**
        *   Eliminate Random Colors: Do not use arbitrary colors (orange, green, blue) for decoration.
        *   Primary Theme (Action/Data): Use `var(--color-brand)` (Teal) for interactive elements, links, and key data values (like numbers in stats cards).
        *   Secondary Theme (Structure): Use `var(--color-secondary)` (Deep Purple) for architectural elements, section headers, and page-level icons.
        *   Neutral Foundation: Use `var(--color-muted)` for labels and secondary text.
        *   Backgrounds: Replace hardcoded hex tints (e.g., `#3b82f610`) with semantic `rgba` values or standard tokens if available.
    *   **Typography:**
        *   Scale: Ensure all headings use the Major Second (`--ms`) scale (e.g., `var(--font-size-h2--ms)`) to prevent jarring size jumps.
        *   Body: Use `var(--line-height-relaxed)` for descriptive paragraphs (`max_width: 65ch`).
    *   **Components & Patterns:**
        *   TokenCopyButton: Replace any static text display of CSS variables (e.g., `var(--my-token)`) with the `<TokenCopyButton />` component.
            *   *Import:* `import { TokenCopyButton } from '@/components/tokens/TokenCopyButton';`
            *   *Usage:* `<TokenCopyButton value="var(--token-name)" displayValue="--token-name" variant="primary" />`
        *   Page Header: Follow the standard pattern:
            1.  Breadcrumbs (Links: Muted -> Current: Foreground).
            2.  Icon Box: 56x56px, Rounded-XL, using `var(--color-secondary)` for the icon and a 10% opacity tint for the background.
            3.  Title: H2 weight 700.
            4.  Description: Body size, Muted color.
        *   Stats/Cards: Uniform design:
            *   Value: `var(--color-brand)`, Bold, H4 size.
            *   Label: `var(--color-muted)`, Caption size, Uppercase tracking.
            *   Container: `var(--color-card)` background, `var(--radius-xl)` border radius, standard border.
    *   **Layout:**
        *   Ensure strictly 4px/8px grid usage (`var(--spacing-4)`, `var(--spacing-8)`).